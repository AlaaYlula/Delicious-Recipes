<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title th:text = "${username} + ' Recipes'"></title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
          crossorigin="anonymous"
    >

    <!-- Font Awesome -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
            rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
            href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
            rel="stylesheet"
    />
    <!-- MDB -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.11.0/mdb.min.css"
            rel="stylesheet"
    />


    <link th:href="@{/Style.css}" rel="stylesheet"/>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <style>
.w3-button {width:150px; }
</style>
</head>
<body>

<!-- Add Own Recipe -->
<button  onclick="openForm()">Add Recipe</button>

<form method="post"  action="/user/newRecipe"  id="myForm" style="display: none;">
    <label for="recipeName">Recipe Name</label>
    <input type="text" id="recipeName" name="name">

    <div class="form-outline">
        <textarea class="form-control" id="description" name="description" rows="4"></textarea>
        <label class="form-label" for="description">Decription</label>
    </div>


    <button type="submit">Add Recipe</button>
</form>
<script>
function openForm() {
  document.getElementById("myForm").style.display = "block";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
}
</script>

<h3>Recipes</h3>
<ul th:each="userRecipe: ${userRecipes}">
    <div class="user">
        <li>
            <div class="container">
<!--                <a th:href="@{/recipe/user(id=${userRecipe.recipe_id})}"></a>-->
                <img   th:src="${userRecipe.thumbnail_url}"></br>
                <label>Recipe Name : </label><span th:text="${userRecipe.name}"></span></br>
                <label>Recipe Description : </label><span th:text="${userRecipe.description}"></span></br>
            </div>
            <h4>comments</h4>
            <ul th:each="comment: ${userRecipe.comments}">
                <div >
                    <li>
                        <div >
                            <label>User  : </label><a th:href = "'/user/account/' + ${comment.userComments.id}" th:text="${comment.userComments.username}"> </a></br>
                            <label>comment :</label><span th:text="${comment.text}"></span></br>
                        </div>

                        <form th:if="${comment.userComments.username == username }"  method="post" action="/comment/delete">
                            <input type="hidden" th:value="${comment.userComments.id}" name="comment_user_id">
                            <input type="hidden" th:value="${userRecipe.userOwnRecipe.id}" name="user_id">
                            <input type="hidden" th:value="${comment.id}" name="id">
                            <button  type="submit">Delete comment</button>
                        </form>
                    </li>
                </div>
                <p>**********************************************************</p>
            </ul>
            <form  method="post" action="/comment">
                <label for="comment">comment</label>
                <input type="text" id="comment" name="text">
                <input type="hidden" th:value="${userRecipe.userOwnRecipe.id}" name="user_id">
                <input type="hidden" th:value="${userRecipe.recipe_id}" name="id">
                <button  type="submit">Add comment</button>
            </form>


            <form method="post" action="/recipe/delete">
                    <input type="hidden"   th:value="${userRecipe.recipe_id}" name="userRecipe_id">
                    <input type="submit" value="Delete Recipe">
                </form>
            <form method="get" action="/recipe/update">
                <input type="hidden" th:value="${userRecipe.recipe_id}" name="recipe_id">
                <input type="hidden" th:value="${userRecipe.name}" name="name">
                <input type="hidden" th:value="${userRecipe.description}" name="description">

                <input type="submit" value="Update Recipe">
            </form>

        </li>
    </div>
</ul>

<p>******************************************************</p>
</body>
</html>